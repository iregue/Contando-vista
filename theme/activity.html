<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="assets/img/favorites-star-icon.png">

    <title>Counting Stars</title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="assets/css/style.css" rel="stylesheet">
    <link href="assets/css/font-awesome.min.css" rel="stylesheet">


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="assets/js/validator/validator.js"></script>

    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <!-- Pluging para cookies-->
    <script src="assets/js/jquery.cookie.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.10/cookieconsent.min.js"></script>
    <!-- End Cookie Consent plugin -->


</head>
<body>

<!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">Contando estrellas</a>
        </div>
        <div class="navbar-collapse collapse navbar-right">
            <ul class="nav navbar-nav">
                <li><a href="index.html">Inicio</a></li>
                <li><a href="registro.html">Registro</a></li>
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Analizar<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="stats.html">Observaciones por país</a></li>
                        <li><a href="activity.html">Actividad de estrellas</a></li>
                    </ul>
                </li>
                <li><a href="about.html">Acerca de</a></li>
                <li><a href="settings.html">Ajustes</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Últimos eventos <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="perseidas16.html">Perseidas 2016</a></li>
                        <li><a href="#">Perseidas 2015</a></li>
                    </ul>
                </li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</div>
<!-----------------------------------FORMULARIO------------------------------------------------------------>
<div class="container mtb">
    <div class="row">
        <div class="col-md-3">

            <h2>Actividad registrada</h2>
            <br>
            <h4>Estrellas avistadas durante un intervalo de tiempo</h4>
            <br>
            <form>
                <div class="form-group">
                    <label>Latitud</label>
                    <input type="text" name="latitude" id="latitude" class="form-control" placeholder="">
                </div>
                <div class="form-group">
                    <label>Longitud</label>
                    <input type="text" name="longitude" id="longitude" class="form-control" placeholder="">
                </div>
                <div class="form-group">
                    <label>Distancia máxima a [Latitud,Longitud] en Km</label>
                    <input type="text" name="distance" id="distance" class="form-control" pattern="^[\d.]+$" placeholder="" >
                </div>
                <div class="form-group">
                    <label>Fecha de inicio</label>
                    <input type="text" class="form-control" name="start_date" id="start_date" placeholder="">
                </div>
                <div class="form-group">
                    <label>Fecha final</label>
                    <input type="text" class="form-control" name="end_date" id="end_date" placeholder="">
                </div>
                <div class="form-group">
                    <label for="nivel_detalle">Nivel de detalle</label>
                    <select class="form-control" id="nivel_detalle" name="nivel_detalle">
                        <option value="30">30 minutos</option>
                        <option value="60">1 hora</option>
                        <option value="1440">1 día</option>
                    </select>
                </div>
                <div class="row col-xs-offset-1">
                    <button type="button" onclick="getActivity()" class="btn btn-danger btn-lg">Enviar</button>
                </div>
                <div class="row col-xs-offset-1"><br>
                    <button type="button" onclick="clearAll()" class="btn btn-primary btn-md">Limpiar mapa</button>
                </div>
            </form>
            </div>
        <div class="col-md-9">
        <h4>Gráfico de actividad</h4><br>

        <div class="row" id="chart_div"></div>
            </div>
        </div>
    </div>
<!-- *****************************************************************************************************************
    FOOTER
    ***************************************************************************************************************** -->
<div id="footerwrap">
    <div class="container">
        <div class="row">
            <div class="col-lg-4">
                <h4>Acerca de</h4>
                <div class="hline-w"></div>
                <p>Esta aplicación ha sido creada para dar soporte a eventos astronómicos con la que se pueda llevar un seguimiento de los bólidos avistados. <br><a href="about.html">Más información</a></p>
            </div>
            <div class="col-lg-4">
                <h4>Desarrollador</h4>
                <div class="hline-w"></div>
                <p>Ignacio Regueiro Tuñon alumno de la Escuela Técnica Superior de Ingenieros Informáticos de la Universidad Politécnica de Madrid ha realizado esta aplicación como trabajo de fin de grado.
                    <br><a href="https://twitter.com/IgnaRegue"><i class="fa fa-twitter"></i></a>
                </p>
            </div>
            <div class="col-lg-4">
                <h4>Donde estamos</h4>
                <div class="hline-w"></div>
                <p>
                    C/ Campus de Montegancedo, s/n<br/>
                    Facultad de Informática-Universidad Politécnica de Madrid<br/>
                    28660-Madrid<br/>
                </p>
            </div>

        </div><! --/row -->
    </div><! --/container -->
</div><! --/footerwrap -->
</body>

<!-- Bootstrap core JavaScript
       ================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/retina-1.1.0.js"></script>
<script src="assets/js/jquery.hoverdir.js"></script>
<script src="assets/js/jquery.hoverex.min.js"></script>
<script src="assets/js/jquery.prettyPhoto.js"></script>
<script src="assets/js/jquery.isotope.min.js"></script>
<script src="assets/js/custom.js"></script>
<script src="assets/js/config.js"></script>
<script src="assets/js/jquery.cookie.js"></script>

<script>

    if(screen.width < 426){
        $("#regions_div").css("width","300px");
        $("#chart_div").css("width","300px");
        $("#regions_div").css("height","300px");
        $("#regions_div").css("margin-left","0px");
        $("#chart_div").css("height","300px");
        //    style="width: 310px; height: 310px;

    }
    if(screen.width > 425 && screen.width <1024){
        $("#regions_div").css("width","510px");
        $("#chart_div").css("width","510px");
        $("#regions_div").css("height","410px");
        $("#regions_div").css("margin-left","0px");
        $("#chart_div").css("height","410px");

        //$("#regions_div").css("padding","100px 0 0");
        //    style="width: 310px; height: 310px;

    }
window.cookieconsent_options = {"message":"This website uses cookies to ensure you get the best experience on our website","dismiss":"Got it!","learnMore":"More info","link":null,"theme":"light-bottom"};

    var $year = [];
    var $month = [];
    var $day = [];
    var $hour = [];
    var $minutes = [];
    var $contador = [];
    var array_iteraciones = 0;
    var ano_inicio = 0;
    var mes_inicio = 0;
    var dia_inicio = 0;
    var hora_inicio = 0;
    var ano_final = 0;
    var mes_final = 0;
    var dia_final = 0;
    var hora_final = 0;

    function clearAll(){
        $year = [];
        $month = [];
        $day = [];
        $hour = [];
        $minutes = [];
        $contador = [];
        array_iteraciones = 0;
        ano_inicio = 0;
        mes_inicio = 0;
        dia_inicio = 0;
        hora_inicio = 0;
        ano_final = 0;
        mes_final = 0;
        dia_final = 0;
        hora_final = 0;
    }

function getActivity() {


var _latitude= $('#latitude').val();
var _longitude= $('#longitude').val();
var _distance= $('#distance').val();
var _start_date= $('#start_date').val();
var _end_date= $('#end_date').val();
var _detail = $('#nivel_detalle').val();

$.cookie('latitude3', _latitude);
 $.cookie('longitude3', _longitude);
 $.cookie('distance3', _distance);
 $.cookie('startdate3', _start_date);
 $.cookie('enddate3', _end_date);
 $.cookie('detail', _detail);


/*$.cookie('latitude2','');
 $.cookie('longitude2', '');
 $.cookie('distance2', '');
 $.cookie('startdate2', '');
 $.cookie('enddate2', '');*/
 $('#latitude').val($.cookie('latitude3'));
 $('#longitude').val($.cookie('longitude3'));
 $('#distance').val($.cookie('distance3'));
 $('#start_date').val($.cookie('startdate3'));
 $('#end_date').val($.cookie('enddate3'));
 $('#nivel_detalle').val($.cookie('detail'));

    //2016-12-22T16:42:55.929Z


$.get("http://"+ADDR_SERV+"/api/observations?lat=" + _latitude + "&lon=" + _longitude + "&distance=" + _distance + "&startdate=" + _start_date + "&enddate=" + _end_date, function (data) {
    //alert("start");

    var total = data.total;
    var limit = data.limit;
    var pages = data.pages;
    var resto = total % limit;
    var pagesCounter = 1;
    var temp_date = data.docs[0].date;
    var date0 = temp_date.split("T");
    var date1 = date0[0].split("-");
    var start_year = date1[0];
    var start_month = date1[1];
    var start_day = date1[2];
    var date2 = date0[1].split(".");
    var date3 = date2[0].split(":");
    var start_hours = date3[0];
    var start_minutes = date3[1];
    var start_seconds = date3[2];
    //var next_section_minutes_st = start_minutes;
    var next_section_minutes = parseInt(start_minutes,10);
    //alert("minutos: "+next_section_minutes);
    //var next_section_hours_st = start_hours;
    var next_section_hours = parseInt(start_hours,10);
    hora_inicio = next_section_hours;
    //alert("horas: "+next_section_hours);
    //var next_section_days_st = start_day;
    var next_section_days = parseInt(start_day,10);
    dia_inicio = next_section_days;
    //alert("dia: "+next_section_days);
    //var next_section_month_st = start_month;
    var next_section_month = parseInt(start_month,10);
    mes_inicio = next_section_month;
    //alert("month: "+next_section_month);
    //var next_section_year_st = start_year;
    var next_section_year = parseInt(start_year,10);
    ano_inicio = next_section_year;
    //alert("year: "+next_section_year);
//Calcula el siguiente nivel de detalle
    if(_detail==30){
        //alert("detail 30");
        next_section_minutes = next_section_minutes + 30;
        //alert("nuevos minutos: "+next_section_minutes);
        if(next_section_minutes>= 60){
            //alert("minutos +60");
            next_section_minutes = next_section_minutes - 60;
            next_section_hours = next_section_hours + 1;
            //alert("minutos actualizados: "+next_section_minutes);
            if(next_section_hours>=24){
                //alert("hour +24");
                next_section_hours = 0;
                next_section_days = next_section_days +1;
                if(next_section_days == 29 && next_section_month == 2){
                    //case febrero
                    next_section_days = 0;
                    next_section_month = 3;
                }
                if(next_section_days == 31 && (next_section_month== 4 || next_section_month == 6 || next_section_month == 9 || next_section_month ==1)){
                    //caso abril, junio, septiembre, noviembre
                    next_section_days = 0;
                    if(next_section_month == 4){
                        next_section_month = 5;
                    }
                    if(next_section_month == 6){
                    next_section_month = 7;

                }
                    if(next_section_month == 9){
                    next_section_month = 10;

                }
                    if(next_section_month == 11){
                    next_section_month = 12;

                }
                }
                if(next_section_days == 32){
                    if(next_section_month == 1){
                        next_section_month =2;
                    }
                    if(next_section_month == 3){
                        next_section_month = 4;
                    }
                    if(next_section_month == 5){
                        next_section_month = 6;
                    }
                    if(next_section_month == 7){
                        next_section_month = 8;
                    }
                    if(next_section_month == 8){
                        next_section_month = 9;

                    }
                    if(next_section_month == 10){
                        next_section_month = 11;

                    }
                    if(next_section_month == 12){
                        next_section_month = 1;
                        next_section_year = next_section_year + 1;

                    }
                }
            }
        }
    }
    if(_detail==60){
        next_section_hours = next_section_hours + 1;
        if(next_section_hours>=24){
            next_section_hours = 0;
            next_section_days = next_section_days +1;
            if(next_section_days == 29 && next_section_month == 2){
                //case febrero
                next_section_days = 0;
                next_section_month = 3;
            }
            if(next_section_days == 31 && (next_section_month== 4 || next_section_month == 6 || next_section_month == 9 || next_section_month ==1)){
                //caso abril, junio, septiembre, noviembre
                next_section_days = 0;
                if(next_section_month == 4){
                    next_section_month = 5;
                }
                if(next_section_month == 6){
                    next_section_month = 7;

                }
                if(next_section_month == 9){
                    next_section_month = 10;

                }
                if(next_section_month == 11){
                    next_section_month = 12;

                }
            }
            if(next_section_days == 32){
                if(next_section_month == 1){
                    next_section_month =2;
                }
                if(next_section_month == 3){
                    next_section_month = 4;
                }
                if(next_section_month == 5){
                    next_section_month = 6;
                }
                if(next_section_month == 7){
                    next_section_month = 8;
                }
                if(next_section_month == 8){
                    next_section_month = 9;

                }
                if(next_section_month == 10){
                    next_section_month = 11;

                }
                if(next_section_month == 12){
                    next_section_month = 1;
                    next_section_year = next_section_year + 1;

                }
            }
        }
    }
    if(_detail==1440){
        next_section_days = next_section_days +1;
        if(next_section_days == 29 && next_section_month == 2){
            //case febrero
            next_section_days = 0;
            next_section_month = 3;
        }
        if(next_section_days == 31 && (next_section_month== 4 || next_section_month == 6 || next_section_month == 9 || next_section_month ==1)){
            //caso abril, junio, septiembre, noviembre
            next_section_days = 0;
            if(next_section_month == 4){
                next_section_month = 5;
            }
            if(next_section_month == 6){
                next_section_month = 7;

            }
            if(next_section_month == 9){
                next_section_month = 10;

            }
            if(next_section_month == 11){
                next_section_month = 12;

            }
        }
        if(next_section_days == 32){
            if(next_section_month == 1){
                next_section_month =2;
            }
            if(next_section_month == 3){
                next_section_month = 4;
            }
            if(next_section_month == 5){
                next_section_month = 6;
            }
            if(next_section_month == 7){
                next_section_month = 8;
            }
            if(next_section_month == 8){
                next_section_month = 9;

            }
            if(next_section_month == 10){
                next_section_month = 11;

            }
            if(next_section_month == 12){
                next_section_month = 1;
                next_section_year = next_section_year + 1;

            }
        }
    }
    var contador_row = 0;
    //alert(pages);
    if(pages==1){
        //alert("paginas = 1");
        var cont = 0;
        var contAux = cont +1;
        //alert("resto: "+resto);
        while (cont < total) {
             temp_date = data.docs[cont].date;
             date0 = temp_date.split("T");
             date1 = date0[0].split("-");
            var _year_st = date1[0];
            var _year = parseInt(_year_st,10);
            var _month_st = date1[1];
            var _month = parseInt(_month_st,10);
            var _day_st = date1[2];
            var _day = parseInt(_day_st,10);
             date2 = date0[1].split(".");
             date3 = date2[0].split(":");
            var _hours_st = date3[0];
            var _hours = parseInt(_hours_st,10);
            var _minutes_st = date3[1];
            var _minutes = parseInt(_minutes_st,10);
            var _seconds_st = date3[2];
            var _seconds = parseInt(_seconds_st,10);
            //busca nueva seccion de grafica respecto a la ultima observacion
            //alert(_year +">="+ next_section_year + " "+ _month + " >="+ next_section_month+ " "+_day+">=" + next_section_days +" "+ _hours +">="+ next_section_hours+" "+ _minutes+ ">"+ next_section_minutes);
            while(_year >= next_section_year && _month >= next_section_month && _day >= next_section_days && _hours >= next_section_hours && _minutes > next_section_minutes){
                //PETICION ADDROW
                //alert("addrow"+ next_section_hours + next_section_minutes);
                $year[array_iteraciones]= next_section_year;
                //alert($year[array_iteraciones]);
                $month[array_iteraciones] = next_section_month;
                $day[array_iteraciones] = next_section_days;
                $hour[array_iteraciones] = next_section_hours;
                $minutes[array_iteraciones] = next_section_minutes;
                $contador[array_iteraciones] = contador_row;
                array_iteraciones = array_iteraciones + 1;
                //alert("peticion addrow"+ "año: "+ next_section_year+"mes:" + next_section_month+"dia: "+next_section_days+"horas: "+next_section_hours+"minutos: "+next_section_minutes+"contador: "+ contador_row);
                //data.addRow([new Date(next_section_year,next_section_month,next_section_days,next_section_hours,next_section_minutes), contador_row]);
                if(_detail==30){
                    next_section_minutes = next_section_minutes + 30;
                    if(next_section_minutes> 60){
                        next_section_minutes = next_section_minutes - 60;
                        next_section_hours = next_section_hours + 1;
                        if(next_section_hours>24){
                            next_section_hours = 0;
                            next_section_days = next_section_days +1;
                            if(next_section_days == 29 && next_section_month == 2){
                                //case febrero
                                next_section_days = 0;
                                next_section_month = 3;
                            }
                            if(next_section_days == 31 && (next_section_month== 4 || next_section_month == 6 || next_section_month == 9 || next_section_month ==1)){
                                //caso abril, junio, septiembre, noviembre
                                next_section_days = 0;
                                if(next_section_month == 4){
                                    next_section_month = 5;
                                }
                                if(next_section_month == 6){
                                    next_section_month = 7;

                                }
                                if(next_section_month == 9){
                                    next_section_month = 10;

                                }
                                if(next_section_month == 11){
                                    next_section_month = 12;

                                }
                            }
                            if(next_section_days == 32){
                                if(next_section_month == 1){
                                    next_section_month =2;
                                }
                                if(next_section_month == 3){
                                    next_section_month = 4;
                                }
                                if(next_section_month == 5){
                                    next_section_month = 6;
                                }
                                if(next_section_month == 7){
                                    next_section_month = 8;
                                }
                                if(next_section_month == 8){
                                    next_section_month = 9;

                                }
                                if(next_section_month == 10){
                                    next_section_month = 11;

                                }
                                if(next_section_month == 12){
                                    next_section_month = 1;
                                    next_section_year = next_section_year + 1;

                                }
                            }
                        }
                    }
                }
                if(_detail==60){
                    next_section_hours = next_section_hours + 1;
                    if(next_section_hours>24){
                        next_section_hours = 0;
                        next_section_days = next_section_days +1;
                        if(next_section_days == 29 && next_section_month == 2){
                            //case febrero
                            next_section_days = 0;
                            next_section_month = 3;
                        }
                        if(next_section_days == 31 && (next_section_month== 4 || next_section_month == 6 || next_section_month == 9 || next_section_month ==1)){
                            //caso abril, junio, septiembre, noviembre
                            next_section_days = 0;
                            if(next_section_month == 4){
                                next_section_month = 5;
                            }
                            if(next_section_month == 6){
                                next_section_month = 7;

                            }
                            if(next_section_month == 9){
                                next_section_month = 10;

                            }
                            if(next_section_month == 11){
                                next_section_month = 12;

                            }
                        }
                        if(next_section_days == 32){
                            if(next_section_month == 1){
                                next_section_month =2;
                            }
                            if(next_section_month == 3){
                                next_section_month = 4;
                            }
                            if(next_section_month == 5){
                                next_section_month = 6;
                            }
                            if(next_section_month == 7){
                                next_section_month = 8;
                            }
                            if(next_section_month == 8){
                                next_section_month = 9;

                            }
                            if(next_section_month == 10){
                                next_section_month = 11;

                            }
                            if(next_section_month == 12){
                                next_section_month = 1;
                                next_section_year = next_section_year + 1;

                            }
                        }
                    }
                }
                if(_detail==1440){
                    next_section_days = next_section_days +1;
                    if(next_section_days == 29 && next_section_month == 2){
                        //case febrero
                        next_section_days = 0;
                        next_section_month = 3;
                    }
                    if(next_section_days == 31 && (next_section_month== 4 || next_section_month == 6 || next_section_month == 9 || next_section_month ==1)){
                        //caso abril, junio, septiembre, noviembre
                        next_section_days = 0;
                        if(next_section_month == 4){
                            next_section_month = 5;
                        }
                        if(next_section_month == 6){
                            next_section_month = 7;

                        }
                        if(next_section_month == 9){
                            next_section_month = 10;

                        }
                        if(next_section_month == 11){
                            next_section_month = 12;

                        }
                    }
                    if(next_section_days == 32){
                        if(next_section_month == 1){
                            next_section_month =2;
                        }
                        if(next_section_month == 3){
                            next_section_month = 4;
                        }
                        if(next_section_month == 5){
                            next_section_month = 6;
                        }
                        if(next_section_month == 7){
                            next_section_month = 8;
                        }
                        if(next_section_month == 8){
                            next_section_month = 9;

                        }
                        if(next_section_month == 10){
                            next_section_month = 11;

                        }
                        if(next_section_month == 12){
                            next_section_month = 1;
                            next_section_year = next_section_year + 1;

                        }
                    }
                }
                contador_row = 0;
                //alert(_year +">="+ next_section_year + " "+ _month + " >="+ next_section_month+ " "+_day+">=" + next_section_days +" "+ _hours +">="+ next_section_hours+" "+ _minutes+ ">"+ next_section_minutes);

            }
            if(contAux < resto){
                    var temp_date2 = data.docs[contAux].date;
                    /*var date02 = temp_date2.split("T");
                    var date12 = date02[0].split("-");
                    var _year2_st = date12[0];
                    var _year2 = parseInt(_year2_st,10);
                    var _month2_st = date12[1];
                    var _month2 = parseInt(_month2_st,10);
                    var _day2_st = date12[2];
                    var _day2 = parseInt(_day2_st,10);
                    var date22 = date02[1].split(".");
                    var date32 = date22[0].split(":");
                    var _hours2_st = date32[0];
                    var _hours2 = parseInt(_hours2_st,10);
                    var _minutes2_st = date32[1];
                    var _minutes2 = parseInt(_minutes2_st,10);
                    var _seconds2_st = date32[2];
                    var _seconds2 = parseInt(_seconds2_st,10);*/

                var found = observationFilter(temp_date,temp_date2);
                /*
                /////////////////////////////////CHECK hora en cambios de minutos horas y dias///////////////////////
                //Se suma 5 seg para comprobar casos iguales y re corrigue hora en caso de sobrepasar los 60seg, 60min, 24h
                    if(_seconds > 54 && _minutes ==59 && _hours ==23){
                        var check_seconds = _seconds +5 - 60;
                        var check_minutes = 0;
                        var check_hours = 0;
                    }
                    if(_seconds > 54 && _minutes == 59 && _hours != 23){
                        var check_seconds = _seconds +5 - 60;
                        var check_minutes = 0;
                        var check_hours = _hours +1;
                    }
                    if(_seconds > 54 && _minutes != 59 && _hours != 23){
                        var check_seconds = _seconds +5 - 60;
                        var check_minutes = _minutes +1;
                        var check_hours = _hours +1;
                    }
                    ///////////////////////////////////////////////////////////////////////////////////////////////////////
                ///////////// CHECK de misma observacion  /////////////////////////////////////
                var found = false;
                if(_year == _year2 && _month == _month2 && _day == _day2) {
                        var temp_second = _seconds + 5;
                        //Analiza casos de dos observaciones, la primera de ellas con segundos que no sobrepasen los 60
                        if (_hours == _hours2 && _minutes == _minutes2 && temp_second >= _seconds2 && temp_second <60) {
                            //Coincide observacion
                            //contAux = contAux +1;
                            found = true;
                        } else {
                            //no coincide observacion
                            found = false;
                        }
                        //Analiza caso de dos observaciones, la primera de ellas, cercana al cambio de minuto, segundo >54
                        if (check_hours == _hours2 && check_minutes == _minutes2 && check_seconds > _seconds2 && found==false) {
                            //coincide observacion
                            //contAux = contAux +1;
                            found = true;
                        } else {
                            //no coincide observacion
                            //contador_row = contador_row +1;
                            found = false;

                        }
                    }
                    else{
                        //no coincide
                    //contador_row = contador_row +1;
                    found = false;
                }*/
            }
            else{
                //no hay otra observacion para comparar con la anterior
            }
            //Se actualiza siguiente observaciones a analizar
            //Si coinciden las 2 ultimas observaciones analizadas, Se pasa a analizar la siguiente observacion
            if(found== true){
                contAux = contAux + 1;
            }
            else{
                //si no coinciden las observaciones, por lo que son 2 distintas, se añade 1 al contador_row
                cont = contAux;
                contAux = contAux + 1;
                contador_row = contador_row +1;

            }
        }
        if(contador_row != 0){
            //ADDROW final de bucle
            $year[array_iteraciones]= next_section_year;
            $month[array_iteraciones] = next_section_month;
            $day[array_iteraciones] = next_section_days;
            $hour[array_iteraciones] = next_section_hours;
            $minutes[array_iteraciones] = next_section_minutes;
            $contador[array_iteraciones] = contador_row;
            array_iteraciones = array_iteraciones +1;
            ano_final = next_section_year;
            mes_final = next_section_month;
            dia_final = next_section_days;
            hora_final = next_section_hours;
            //alert("peticion addrow"+ "año: "+ next_section_year+"mes:" + next_section_month+"dia: "+next_section_days+"horas: "+next_section_hours+"minutos: "+next_section_minutes+"contador: "+contador_row);
            //data.addRow([new Date(next_section_year,next_section_month,next_section_days,next_section_hours,next_section_minutes), contador_row]);
        }
        //alert(array_iteraciones);
        drawChart();
    }
    else {
        //Page > 1
        //alert("page>1")
        var cont = 0;
        var contAux = cont + 1;
        //while (pagesCounter < pages) {
        var i;
        for (i =1; i< pages;i++) {
            //alert(i +"<"+ pages);
            //alert("contadores a 0");

            $.get("http://"+ADDR_SERV+"/api/observations?lat=" + _latitude + "&lon=" + _longitude + "&distance=" + _distance + "&startdate=" + _start_date + "&enddate=" + _end_date + "&page=" + i, function (data) {

                cont = 0;
                contAux = cont + 1;

                while (cont < limit) {
                    //alert(cont+ "<" +limit);
                    temp_date = data.docs[cont].date;
                    date0 = temp_date.split("T");
                    date1 = date0[0].split("-");
                    var _year_st = date1[0];
                    var _year = parseInt(_year_st,10);
                    var _month_st = date1[1];
                    var _month = parseInt(_month_st,10);
                    var _day_st = date1[2];
                    var _day = parseInt(_day_st,10);
                    date2 = date0[1].split(".");
                    date3 = date2[0].split(":");
                    var _hours_st = date3[0];
                    var _hours = parseInt(_hours_st,10);
                    var _minutes_st = date3[1];
                    var _minutes = parseInt(_minutes_st,10);
                    var _seconds_st = date3[2];
                    var _seconds = parseInt(_seconds_st,10);
                    //alert(_year +">="+ next_section_year + " "+ _month + " >="+ next_section_month+ " "+_day+">=" + next_section_days +" "+ _hours +">="+ next_section_hours+" "+ _minutes+ ">"+ next_section_minutes);
                    while (_year >= next_section_year && _month >= next_section_month && _day >= next_section_days && _hours >= next_section_hours && _minutes > next_section_minutes) {
                        //PETICION ADDROW
                        alert("peticion addrow"+ pagesCounter);
                        $year[array_iteraciones]= next_section_year;
                        //alert($year[array_iteraciones]);
                        $month[array_iteraciones] = next_section_month;
                        $day[array_iteraciones] = next_section_days;
                        $hour[array_iteraciones] = next_section_hours;
                        $minutes[array_iteraciones] = next_section_minutes;
                        $contador[array_iteraciones] = contador_row;
                        array_iteraciones = array_iteraciones + 1;
                        //data.addRow([new Date(next_section_year,next_section_month,next_section_days,next_section_hours,next_section_minutes), contador_row]);
                        if (_detail == 30) {
                            next_section_minutes = next_section_minutes + 30;
                            if (next_section_minutes > 60) {
                                next_section_minutes = next_section_minutes - 60;
                                next_section_hours = next_section_hours + 1;
                                if (next_section_hours > 24) {
                                    next_section_hours = 0;
                                    next_section_days = next_section_days + 1;
                                    if (next_section_days == 29 && next_section_month == 2) {
                                        //case febrero
                                        next_section_days = 0;
                                        next_section_month = 3;
                                    }
                                    if (next_section_days == 31 && (next_section_month == 4 || next_section_month == 6 || next_section_month == 9 || next_section_month == 1)) {
                                        //caso abril, junio, septiembre, noviembre
                                        next_section_days = 0;
                                        if (next_section_month == 4) {
                                            next_section_month = 5;
                                        }
                                        if (next_section_month == 6) {
                                            next_section_month = 7;

                                        }
                                        if (next_section_month == 9) {
                                            next_section_month = 10;

                                        }
                                        if (next_section_month == 11) {
                                            next_section_month = 12;

                                        }
                                    }
                                    if (next_section_days == 32) {
                                        if (next_section_month == 1) {
                                            next_section_month = 2;
                                        }
                                        if (next_section_month == 3) {
                                            next_section_month = 4;
                                        }
                                        if (next_section_month == 5) {
                                            next_section_month = 6;
                                        }
                                        if (next_section_month == 7) {
                                            next_section_month = 8;
                                        }
                                        if (next_section_month == 8) {
                                            next_section_month = 9;

                                        }
                                        if (next_section_month == 10) {
                                            next_section_month = 11;

                                        }
                                        if (next_section_month == 12) {
                                            next_section_month = 1;
                                            next_section_year = next_section_year + 1;

                                        }
                                    }
                                }
                            }
                        }
                        if (_detail == 60) {
                            next_section_hours = next_section_hours + 1;
                            if (next_section_hours > 24) {
                                next_section_hours = 0;
                                next_section_days = next_section_days + 1;
                                if (next_section_days == 29 && next_section_month == 2) {
                                    //case febrero
                                    next_section_days = 0;
                                    next_section_month = 3;
                                }
                                if (next_section_days == 31 && (next_section_month == 4 || next_section_month == 6 || next_section_month == 9 || next_section_month == 1)) {
                                    //caso abril, junio, septiembre, noviembre
                                    next_section_days = 0;
                                    if (next_section_month == 4) {
                                        next_section_month = 5;
                                    }
                                    if (next_section_month == 6) {
                                        next_section_month = 7;

                                    }
                                    if (next_section_month == 9) {
                                        next_section_month = 10;

                                    }
                                    if (next_section_month == 11) {
                                        next_section_month = 12;

                                    }
                                }
                                if (next_section_days == 32) {
                                    if (next_section_month == 1) {
                                        next_section_month = 2;
                                    }
                                    if (next_section_month == 3) {
                                        next_section_month = 4;
                                    }
                                    if (next_section_month == 5) {
                                        next_section_month = 6;
                                    }
                                    if (next_section_month == 7) {
                                        next_section_month = 8;
                                    }
                                    if (next_section_month == 8) {
                                        next_section_month = 9;

                                    }
                                    if (next_section_month == 10) {
                                        next_section_month = 11;

                                    }
                                    if (next_section_month == 12) {
                                        next_section_month = 1;
                                        next_section_year = next_section_year + 1;

                                    }
                                }
                            }
                        }
                        if (_detail == 1440) {
                            next_section_days = next_section_days + 1;
                            if (next_section_days == 29 && next_section_month == 2) {
                                //case febrero
                                next_section_days = 0;
                                next_section_month = 3;
                            }
                            if (next_section_days == 31 && (next_section_month == 4 || next_section_month == 6 || next_section_month == 9 || next_section_month == 1)) {
                                //caso abril, junio, septiembre, noviembre
                                next_section_days = 0;
                                if (next_section_month == 4) {
                                    next_section_month = 5;
                                }
                                if (next_section_month == 6) {
                                    next_section_month = 7;

                                }
                                if (next_section_month == 9) {
                                    next_section_month = 10;

                                }
                                if (next_section_month == 11) {
                                    next_section_month = 12;

                                }
                            }
                            if (next_section_days == 32) {
                                if (next_section_month == 1) {
                                    next_section_month = 2;
                                }
                                if (next_section_month == 3) {
                                    next_section_month = 4;
                                }
                                if (next_section_month == 5) {
                                    next_section_month = 6;
                                }
                                if (next_section_month == 7) {
                                    next_section_month = 8;
                                }
                                if (next_section_month == 8) {
                                    next_section_month = 9;

                                }
                                if (next_section_month == 10) {
                                    next_section_month = 11;

                                }
                                if (next_section_month == 12) {
                                    next_section_month = 1;
                                    next_section_year = next_section_year + 1;

                                }
                            }
                        }
                        contador_row = 0;
                    }
                    //var found = false;

                    if (contAux < limit) {
                        var temp_date2 = data.docs[contAux].date;
                        /*var date02 = temp_date2.split("T");
                        var date12 = date02[0].split("-");
                        var _year2_st = date12[0];
                        var _year2 = parseInt(_year2_st,10);
                        var _month2_st = date12[1];
                        var _month2 = parseInt(_month2_st,10);
                        var _day2_st = date12[2];
                        var _day2 = parseInt(_day2_st,10);
                        var date22 = date02[1].split(".");
                        var date32 = date22[0].split(":");
                        var _hours2_st = date32[0];
                        var _hours2 = parseInt(_hours2_st,10);
                        var _minutes2_st = date32[1];
                        var _minutes2 = parseInt(_minutes2_st,10);
                        var _seconds2_st = date32[2];
                        var _seconds2 = parseInt(_seconds2_st,10);*/

                        var found =observationFilter(temp_date, temp_date2);

                        /*
                        /////////////////////////////////CHECK hora en cambios de minutos horas y dias///////////////////////
                        //Se suma 5 seg para comprobar casos iguales y re corrigue hora en caso de sobrepasar los 60seg, 60min, 24h
                        if (_seconds > 54 && _minutes == 59 && _hours == 23) {
                            var check_seconds = _seconds + 5 - 60;
                            var check_minutes = 0;
                            var check_hours = 0;
                        }
                        if (_seconds > 54 && _minutes == 59 && _hours != 23) {
                            var check_seconds = _seconds + 5 - 60;
                            var check_minutes = 0;
                            var check_hours = _hours + 1;
                        }
                        if (_seconds > 54 && _minutes != 59 && _hours != 23) {
                            var check_seconds = _seconds + 5 - 60;
                            var check_minutes = _minutes + 1;
                            var check_hours = _hours + 1;
                        }
                        ///////////////////////////////////////////////////////////////////////////////////////////////////////
                        ///////////// CHECK de misma observacion  /////////////////////////////////////
                        if(_year == _year2 && _month == _month2 && _day == _day2) {
                            var temp_second = _seconds + 5;
                            //Analiza casos de dos observaciones, la primera de ellas con segundos que no sobrepasen los 60
                            if (_hours == _hours2 && _minutes == _minutes2 && temp_second >= _seconds2 && temp_second <60) {
                                //Coincide observacion
                                //contAux = contAux +1;
                                found = true;
                            } else {
                                //no coincide observacion
                                found = false;
                            }
                            //Analiza caso de dos observaciones, la primera de ellas, cercana al cambio de minuto, segundo >54
                            if (check_hours == _hours2 && check_minutes == _minutes2 && check_seconds > _seconds2 && found==false) {
                                //coincide observacion
                                //contAux = contAux +1;
                                found = true;
                            } else {
                                //no coincide observacion
                                //contador_row = contador_row +1;
                                found = false;

                            }
                        }
                        else{
                            //no coincide
                            //contador_row = contador_row +1;
                            found = false;

                        }*/
                    }
                    else {
                        //no hay otra observacion para comparar con la anterior
                    }
                    //Se actualiza siguiente observaciones a analizar
                    //Si coinciden las 2 ultimas observaciones analizadas, Se pasa a analizar la siguiente observacion
                    if (found == true) {
                        contAux = contAux + 1;
                        if(contAux >= limit){
                            cont = limit;
                            //alert("CONT = LIMIT")
                        }
                    }
                    else {
                        //si no coinciden las observaciones, por lo que son 2 distintas, se añade 1 al contador_row
                        cont = contAux;
                        contAux = contAux + 1;
                        contador_row = contador_row + 1;

                    }
                }//end while
                pagesCounter = pagesCounter +1;
                cont = 0;
                contAux = cont + 1;
            });
            //alert("incremento pages");
            //pagesCounter = pagesCounter + 1;
        }//end while pages
        //ultima iteracion

        //if (pagesCounter == pages) {
            //alert("LAST");
            $.get("http://"+ADDR_SERV+"/api/observations?lat=" + _latitude + "&lon=" + _longitude + "&distance=" + _distance + "&startdate=" + _start_date + "&enddate=" + _end_date + "&page=" + pages, function (data) {
            //alert("ENTRA GET");
            cont = 0;
            contAux = cont + 1;
                //alert(cont +"< "+ resto);
            while (cont < resto) {
                temp_date = data.docs[cont].date;
                date0 = temp_date.split("T");
                date1 = date0[0].split("-");
                var _year_st = date1[0];
                var _year = parseInt(_year_st,10);
                var _month_st = date1[1];
                var _month = parseInt(_month_st,10);
                var _day_st = date1[2];
                var _day = parseInt(_day_st,10);
                date2 = date0[1].split(".");
                date3 = date2[0].split(":");
                var _hours_st = date3[0];
                var _hours = parseInt(_hours_st,10);
                var _minutes_st = date3[1];
                var _minutes = parseInt(_minutes_st,10);
                var _seconds_st = date3[2];
                var _seconds = parseInt(_seconds_st,10);
                while (_year >= next_section_year && _month >= next_section_month && _day >= next_section_days && _hours >= next_section_hours && _minutes > next_section_minutes) {
                    //PETICION ADDROW
                    //alert("addrow last iterations");
                    $year[array_iteraciones]= next_section_year;
                    //alert($year[array_iteraciones]);
                    $month[array_iteraciones] = next_section_month;
                    $day[array_iteraciones] = next_section_days;
                    $hour[array_iteraciones] = next_section_hours;
                    $minutes[array_iteraciones] = next_section_minutes;
                    $contador[array_iteraciones] = contador_row;
                    array_iteraciones = array_iteraciones + 1;
                    //data.addRow([new Date(next_section_year,next_section_month,next_section_days,next_section_hours,next_section_minutes), contador_row]);
                    if (_detail == 30) {
                        next_section_minutes = next_section_minutes + 30;
                        if (next_section_minutes > 60) {
                            next_section_minutes = next_section_minutes - 60;
                            next_section_hours = next_section_hours + 1;
                            if (next_section_hours > 24) {
                                next_section_hours = 0;
                                next_section_days = next_section_days + 1;
                                if (next_section_days == 29 && next_section_month == 2) {
                                    //case febrero
                                    next_section_days = 0;
                                    next_section_month = 3;
                                }
                                if (next_section_days == 31 && (next_section_month == 4 || next_section_month == 6 || next_section_month == 9 || next_section_month == 1)) {
                                    //caso abril, junio, septiembre, noviembre
                                    next_section_days = 0;
                                    if (next_section_month == 4) {
                                        next_section_month = 5;
                                    }
                                    if (next_section_month == 6) {
                                        next_section_month = 7;

                                    }
                                    if (next_section_month == 9) {
                                        next_section_month = 10;

                                    }
                                    if (next_section_month == 11) {
                                        next_section_month = 12;

                                    }
                                }
                                if (next_section_days == 32) {
                                    if (next_section_month == 1) {
                                        next_section_month = 2;
                                    }
                                    if (next_section_month == 3) {
                                        next_section_month = 4;
                                    }
                                    if (next_section_month == 5) {
                                        next_section_month = 6;
                                    }
                                    if (next_section_month == 7) {
                                        next_section_month = 8;
                                    }
                                    if (next_section_month == 8) {
                                        next_section_month = 9;

                                    }
                                    if (next_section_month == 10) {
                                        next_section_month = 11;

                                    }
                                    if (next_section_month == 12) {
                                        next_section_month = 1;
                                        next_section_year = next_section_year + 1;

                                    }
                                }
                            }
                        }
                    }
                    if (_detail == 60) {
                        next_section_hours = next_section_hours + 1;
                        if (next_section_hours > 24) {
                            next_section_hours = 0;
                            next_section_days = next_section_days + 1;
                            if (next_section_days == 29 && next_section_month == 2) {
                                //case febrero
                                next_section_days = 0;
                                next_section_month = 3;
                            }
                            if (next_section_days == 31 && (next_section_month == 4 || next_section_month == 6 || next_section_month == 9 || next_section_month == 1)) {
                                //caso abril, junio, septiembre, noviembre
                                next_section_days = 0;
                                if (next_section_month == 4) {
                                    next_section_month = 5;
                                }
                                if (next_section_month == 6) {
                                    next_section_month = 7;

                                }
                                if (next_section_month == 9) {
                                    next_section_month = 10;

                                }
                                if (next_section_month == 11) {
                                    next_section_month = 12;

                                }
                            }
                            if (next_section_days == 32) {
                                if (next_section_month == 1) {
                                    next_section_month = 2;
                                }
                                if (next_section_month == 3) {
                                    next_section_month = 4;
                                }
                                if (next_section_month == 5) {
                                    next_section_month = 6;
                                }
                                if (next_section_month == 7) {
                                    next_section_month = 8;
                                }
                                if (next_section_month == 8) {
                                    next_section_month = 9;

                                }
                                if (next_section_month == 10) {
                                    next_section_month = 11;

                                }
                                if (next_section_month == 12) {
                                    next_section_month = 1;
                                    next_section_year = next_section_year + 1;

                                }
                            }
                        }
                    }
                    if (_detail == 1440) {
                        next_section_days = next_section_days + 1;
                        if (next_section_days == 29 && next_section_month == 2) {
                            //case febrero
                            next_section_days = 0;
                            next_section_month = 3;
                        }
                        if (next_section_days == 31 && (next_section_month == 4 || next_section_month == 6 || next_section_month == 9 || next_section_month == 1)) {
                            //caso abril, junio, septiembre, noviembre
                            next_section_days = 0;
                            if (next_section_month == 4) {
                                next_section_month = 5;
                            }
                            if (next_section_month == 6) {
                                next_section_month = 7;

                            }
                            if (next_section_month == 9) {
                                next_section_month = 10;

                            }
                            if (next_section_month == 11) {
                                next_section_month = 12;

                            }
                        }
                        if (next_section_days == 32) {
                            if (next_section_month == 1) {
                                next_section_month = 2;
                            }
                            if (next_section_month == 3) {
                                next_section_month = 4;
                            }
                            if (next_section_month == 5) {
                                next_section_month = 6;
                            }
                            if (next_section_month == 7) {
                                next_section_month = 8;
                            }
                            if (next_section_month == 8) {
                                next_section_month = 9;

                            }
                            if (next_section_month == 10) {
                                next_section_month = 11;

                            }
                            if (next_section_month == 12) {
                                next_section_month = 1;
                                next_section_year = next_section_year + 1;

                            }
                        }
                    }
                    contador_row = 0;
                }
                //var found = false;

                if (contAux < resto) {
                    var temp_date2 = data.docs[contAux].date;
                    /*var date02 = temp_date2.split("T");
                    var date12 = date02[0].split("-");
                    var _year2_st = date12[0];
                    var _year2 = parseInt(_year2_st,10);
                    var _month2_st = date12[1];
                    var _month2 = parseInt(_month2_st,10);
                    var _day2_st = date12[2];
                    var _day2 = parseInt(_day2_st,10);
                    var date22 = date02[1].split(".");
                    var date32 = date22[0].split(":");
                    var _hours2_st = date32[0];
                    var _hours2 = parseInt(_hours2_st,10);
                    var _minutes2_st = date32[1];
                    var _minutes2 = parseInt(_minutes2_st,10);
                    var _seconds2_st = date32[2];
                    var _seconds2 = parseInt(_seconds2_st,10);*/

                    var found = observationFilter(temp_date,temp_date2);
                    /*
                    /////////////////////////////////CHECK hora en cambios de minutos horas y dias///////////////////////
                    //Se suma 5 seg para comprobar casos iguales y re corrigue hora en caso de sobrepasar los 60seg, 60min, 24h
                    if (_seconds > 54 && _minutes == 59 && _hours == 23) {
                        var check_seconds = _seconds + 5 - 60;
                        var check_minutes = 0;
                        var check_hours = 0;
                    }
                    if (_seconds > 54 && _minutes == 59 && _hours != 23) {
                        var check_seconds = _seconds + 5 - 60;
                        var check_minutes = 0;
                        var check_hours = _hours + 1;
                    }
                    if (_seconds > 54 && _minutes != 59 && _hours != 23) {
                        var check_seconds = _seconds + 5 - 60;
                        var check_minutes = _minutes + 1;
                        var check_hours = _hours + 1;
                    }
                    ///////////////////////////////////////////////////////////////////////////////////////////////////////
                    ///////////// CHECK de misma observacion  /////////////////////////////////////
                    if(_year == _year2 && _month == _month2 && _day == _day2) {
                        var temp_second = _seconds + 5;
                        //Analiza casos de dos observaciones, la primera de ellas con segundos que no sobrepasen los 60
                        if (_hours == _hours2 && _minutes == _minutes2 && temp_second >= _seconds2 && temp_second <60) {
                            //Coincide observacion
                            //contAux = contAux +1;
                            found = true;
                        } else {
                            //no coincide observacion
                            found = false;
                        }
                        //Analiza caso de dos observaciones, la primera de ellas, cercana al cambio de minuto, segundo >54
                        if (check_hours == _hours2 && check_minutes == _minutes2 && check_seconds > _seconds2 && found==false) {
                            //coincide observacion
                            //contAux = contAux +1;
                            found = true;
                        } else {
                            //no coincide observacion
                            //contador_row = contador_row +1;
                            found = false;

                        }
                    }
                    else{
                        //no coincide
                        //contador_row = contador_row +1;
                        found = false;

                    }*/
                }
                else {
                    //no hay otra observacion para comparar con la anterior
                }
                //Se actualiza siguiente observaciones a analizar
                //Si coinciden las 2 ultimas observaciones analizadas, Se pasa a analizar la siguiente observacion
                if (found == true) {
                    contAux = contAux + 1;
                }
                else {
                    //si no coinciden las observaciones, por lo que son 2 distintas, se añade 1 al contador_row
                    cont = contAux;
                    contAux = contAux + 1;
                    contador_row = contador_row + 1;

                }
            }
            if (contador_row != 0) {
                //ADDROW final de
                //alert("addrow END");
                $year[array_iteraciones]= next_section_year;
                $month[array_iteraciones] = next_section_month;
                $day[array_iteraciones] = next_section_days;
                $hour[array_iteraciones] = next_section_hours;
                $minutes[array_iteraciones] = next_section_minutes;
                $contador[array_iteraciones] = contador_row;
                array_iteraciones = array_iteraciones +1;
                ano_final = next_section_year;
                mes_final = next_section_month;
                dia_final = next_section_days;
                hora_final = next_section_hours;
                //data.addRow([new Date(next_section_year,next_section_month,next_section_days,next_section_hours,next_section_minutes), contador_row]);
            }
            pagesCounter = pagesCounter + 1;
                drawChart();
            });
        //}
    //});
    }
   /* while (elementCounter < resto) {
        var temp_country = data.docs[elementCounter].country;
        //alert(temp_country);
        foundCountry(temp_country);
        elementCounter = elementCounter + 1;
    }*/
});

}

function observationFilter(date1,date2){
    var fecha1 = new Date(date1);
    var fecha2 = new Date(date2);
    var millis_fecha1 = fecha1.getTime();
    var millis_fecha2 = fecha2.getTime();
    if(millis_fecha1 + 5000>= millis_fecha2){
        return true;
    }
    return false;
}

    google.charts.load('current', {'packages':['corechart', 'line']});
    google.charts.setOnLoadCallback(drawChart);


    function drawChart() {
        //alert("funcion drawChart");
        var data = new google.visualization.DataTable();
        data.addColumn('date', 'Date');
        data.addColumn('number', 'Bólidos');

        //getActivity();


        //data.addRow([new Date(1400,1,1,1,1), 4]);
        /*data.addRows([
            [new Date(1400, 1, 1,4,1),  37],
            [new Date(1400, 1, 2,15,1),  11],
            [new Date(1400, 1, 2,23,1),  11]
        ]);*/
        /*var _start_date_draw= $('#start_date').val();
        var _end_date_draw= $('#end_date').val();
        if(_start_date_draw != null && _end_date_draw != null){
            var date0 = _start_date_draw.split("T");
            var date1 = date0[0].split("-");
            var start_year = date1[0];
            var start_month = date1[1];
            var start_day = date1[2];
            alert(start_year);
            alert(start_month);
            alert(start_day);
        }*/
        var a= 50;
        for(var i = 0; i<array_iteraciones;i++){
            data.addRow([new Date($year[i],$month[i],$day[i],$hour[i],$minutes[i]), $contador[i]]);
        }
        //alert($year[0]+" "+$month[0]+" "+$day[0]+" "+$hour[0]+" "+$minutes[0]+" "+ $contador[0]);
        //data.addRow([new Date($year[0],$month[0],$day[0],$hour[0],$minutes[0]), $contador[0]]);
        //data.addRow([new Date($year[1],$month[1],$day[1],$hour[1],$minutes[1]), $contador[1]]);
        //data.addRow([new Date(1400,1,1,1,1), 4]);
        var linearOptions = {
            title: 'Numero de estrellas observadas',
            legend: 'none',
            hAxis: {
                title: 'Fecha',
                ticks: [new Date(ano_inicio,mes_inicio,dia_inicio,hora_inicio), new Date(ano_final,mes_final,dia_final,hora_final)]
            },
            vAxis: {
                title: 'Numero de estrellas',
                ticks: [0, a/4, a/2, 3*a/4, a]
            }
        };

        var linearChart = new google.visualization.LineChart(document.getElementById('chart_div'));

        linearChart.draw(data, linearOptions);

    }

</script>
</html>